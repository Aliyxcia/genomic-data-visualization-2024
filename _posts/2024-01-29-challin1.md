---
layout: post
title:  "Mean-Variance Trend of Visum Gene Expression"
author: Caleb Hallinan
jhed: challin1
categories: [ HW1 ]
image: homework/hw1/hw1_challin1.png
featured: false
---

### What data types are you visualizing?


### What data encodings (geometric primitives and visual channels) are you using to visualize these data types?


### What about the data are you trying to make salient through this data visualization? 

### What Gestalt principles or knowledge about perceptiveness of visual encodings are you using to accomplish this?

```{r}
# Eevee sequencing data class 1/26

# import libraries
library(here)
library(ggplot2)
library(tidyverse)
library(ggrepel)


# read in data
data = read.csv(here("data/eevee.csv.gz"), row.names = 1)

# QC
dim(data)
head(data)
colnames(data)
rownames(data)

# grab only genes and expression
X = data |>
  select(!c(barcode, aligned_x, aligned_y))

# log1p transform data
X = log(X + 1)

# get mean and variance for each gene
mean_genes <- apply(X, 2, mean)
var_genes <- apply(X, 2, var)

# combine mean and variance into a data frame
mean_var_df <- data.frame(mean_genes, var_genes)

# add gene names as a column
mean_var_df$genes <- rownames(mean_var_df)
rownames(mean_var_df) <- NULL

# plot
ggplot(mean_var_df) +
  # geom point for mean/variance
  geom_point(aes(x = mean_genes, y = var_genes)) +
  # label high variance genes
  geom_label_repel(aes(x = mean_genes, y = var_genes, label=ifelse(var_genes>2, as.character(genes),'')),
                   box.padding   = 0.35,
                   point.padding = 0.5,
                   segment.color = 'grey50') +
  # label high mean genes
  geom_label_repel(aes(x = mean_genes, y = var_genes, label=ifelse(mean_genes>4, as.character(genes),'')),
                   box.padding   = 0.35,
                   point.padding = 0.5,
                   segment.color = 'grey50') +
  # theme
  theme_classic() +
  # labels
  labs(
    x = "Mean of counts",
    y = "Variance of counts",
    title = "Mean-Variance Trend"
    ) +
  # text edit
  theme(
    plot.title = element_text(hjust = 0.5, face="bold", size=18),
    text = element_text(size = 14)
  )
```
