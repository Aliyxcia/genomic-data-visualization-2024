---
layout: post
title:  "Centroid positions, cell and nucleus areas of each cell"
author: April Yan
jhed: yyan67
categories: [ HW3 ]
image: homework/hw2/hw3_yyan67.png
featured: false
---

## What genes (or other cell features such as area or total genes detected) are driving my reduced dimensional components?

Write a description describing your data visualization using vocabulary terms from Lesson 1. You must include the entire code you used to generate the figure so that it can be reproduced. You must provide attribution to external resources referenced (if any) in writing your code. 


## Please share the code you used to reproduce this data visualization.
```{r}
library(patchwork)
library(ggplot2)
library(dplyr) # install it if you don't have it
data <- read.csv('pikachu.csv.gz', row.names = 1)
data$total_count <- rowSums(data[ ,6:ncol(data)], na.rm=TRUE)
df <- data[,2:ncol(data)]
PC <- prcomp(df)$x[,1:2]
loadings <- princomp(df)$loadings[,1:2]

x.df <- data.frame(pc = PC, gene.count=df$total_count)
load.df <- data.frame(loadings)
load.df$feature = rownames(load.df)
p1 <- ggplot(x.df) + geom_point(aes(x=pc.PC1, y=pc.PC2, color=gene.count), alpha=0.5) +
  scale_color_continuous(type='viridis', direction=-1)

# plot top 10 loadings for pc1 and pc2
p2 <- load.df %>% top_n(10, Comp.1) %>% ggplot(aes(x=feature, y=Comp.1)) +
  geom_point(size=3) + ylab('PC1 loading') +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

p3 <- load.df %>% top_n(10, Comp.2) %>% ggplot(aes(x=feature, y=Comp.2)) +
  geom_point(size=3) + ylab('PC2 loading') +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
p1+p2+p3
```
